<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Iowa Education by County</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Iowa Education by County_files/libs/clipboard/clipboard.min.js"></script>
<script src="Iowa Education by County_files/libs/quarto-html/quarto.js"></script>
<script src="Iowa Education by County_files/libs/quarto-html/popper.min.js"></script>
<script src="Iowa Education by County_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Iowa Education by County_files/libs/quarto-html/anchor.min.js"></script>
<link href="Iowa Education by County_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Iowa Education by County_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Iowa Education by County_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Iowa Education by County_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Iowa Education by County_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Iowa Education by County</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="analyzing-iowa-educational-attainment-by-county" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-iowa-educational-attainment-by-county">Analyzing Iowa Educational Attainment by County</h2>
<p>We analyze various levels of educational attainment by county in Iowa, and compare this with the overall population of the county and the median county income. In addition, we investigate how this varies geographically and if geographic location serves as an indicator of educational attainment. We will consider data concerning 2019 from our data sources.</p>
<p>We will get data from the following sites:</p>
<ul>
<li>Estimates of Educational Attainment for Population Over 25 Years by County from <a href="https://data.iowa.gov/Community-Demographics/Iowa-Population-25-Years-and-Over-Educational-Atta/jmdm-eaqx/about_data">www.data.iowa.gov</a></li>
<li>Median Household Income by County from <a href="https://www.iowadatacenter.org/index.php/data-by-source/other/median-household-income">www.iowadatacenter.org</a></li>
<li>Estimates for County Population in 2019 from <a href="https://www.census.gov/data/tables/time-series/demo/popest/2010s-counties-total.html">www.census.gov</a></li>
</ul>
<p>Since we are interested in the relationship of geography of education, income, and population we overlay a grid system to the counties starting in the southwest corner of the state. This results in essentially a 11x9 grid with a few exceptions made for a few larger than typical counties and on the eastern edge of the state being assigned a 12 horizontally and a 4.5 vertically.</p>
</section>
<section id="preparing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-data">Preparing the Data</h2>
<p>We start by preparing the data for the analysis. This includes cleaning the data, summarizing the data by different levels of educational attainment, and joining the data sets together.</p>
<section id="data-cleaning" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h3>
<p>We clean the various datasets by fixing names, uniformizing values, and removing columns and rows we wonâ€™t use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean the education data to get county level data ending in 2019, </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#including recording Master's degrees as a grad degree</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>iowa_ed<span class="ot">&lt;-</span>iowa_ed_raw <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">13</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">"county"</span>,data_collection_period<span class="sc">==</span><span class="st">"2015-2019"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span>(<span class="fu">str_replace_all</span>(name,<span class="st">" County, Iowa"</span>,<span class="st">""</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(name,educational_category) <span class="sc">|&gt;</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">educational_category=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(educational_category),<span class="st">"Total Over 25"</span>,educational_category)) <span class="sc">|&gt;</span> </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">variable_description=</span><span class="fu">factor</span>(variable_description),<span class="at">educational_category=</span><span class="fu">ordered</span>(educational_category,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Less than High School"</span>,<span class="st">"High School Graduate"</span>,<span class="st">"Some College or Associates Degree"</span>,<span class="st">"Bachelors Degree or Higher"</span>,<span class="st">"Total Over 25"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">graduate_degree=</span><span class="fu">if_else</span>(variable_description<span class="sc">==</span><span class="st">"Master's degree"</span>,<span class="st">"Yes"</span>,graduate_degree))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean the population data</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>population<span class="ot">&lt;-</span>population_raw <span class="sc">|&gt;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">13</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(geographic_area<span class="sc">!=</span><span class="st">"Iowa"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geographic_area=</span><span class="fu">str_replace_all</span>(geographic_area,<span class="st">" County, Iowa"</span>,<span class="st">""</span>),<span class="at">geographic_area=</span><span class="fu">str_remove_all</span>(geographic_area,<span class="st">'</span><span class="sc">\\</span><span class="st">.'</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">population_2019=</span>x2019)<span class="sc">|&gt;</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geographic_area=</span><span class="fu">str_to_lower</span>(geographic_area),<span class="at">population_2019=</span><span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(population_2019,<span class="st">'</span><span class="sc">\\</span><span class="st">,'</span>)))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean the income data</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>income<span class="ot">&lt;-</span>income_raw <span class="sc">|&gt;</span> </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">14</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>( )<span class="sc">|&gt;</span> </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">income_2019=</span>x2019) <span class="sc">|&gt;</span> </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geographic_name=</span><span class="fu">str_replace_all</span>(geographic_name,<span class="st">" County"</span>,<span class="st">""</span>),<span class="at">income_2019=</span><span class="fu">str_remove_all</span>(income_2019,<span class="st">'</span><span class="sc">\\</span><span class="st">$|.00$|</span><span class="sc">\\</span><span class="st">,'</span>),<span class="at">income_2019=</span><span class="fu">as.numeric</span>(income_2019))<span class="sc">|&gt;</span> </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">geographic_name=</span><span class="fu">str_to_lower</span>(geographic_name))</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Clean the grid data, including the apostrophe in o'brien</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>grid_numbers<span class="ot">&lt;-</span>grid_raw <span class="sc">|&gt;</span> </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county_name=</span><span class="fu">str_to_lower</span>(county_name))</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(county_name=str_to_lower(county_name),x_location=factor(x_location,levels=1:12),y_location=factor(y_location,levels=c(1:4,4.5,5:9)))</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>grid_numbers[<span class="dv">82</span>,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">'o</span><span class="sc">\'</span><span class="st">brien'</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co">#get the map data, and fix the value for O'Brien County</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>ia_county <span class="ot">&lt;-</span> <span class="fu">map_data</span>(<span class="st">"county"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"iowa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subregion=</span><span class="fu">if_else</span>(subregion<span class="sc">==</span><span class="st">"obrien"</span>,<span class="st">"o'brien"</span>,subregion))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Iowa%20Grid.png" class="img-fluid figure-img"></p>
<figcaption>Iowa Grid</figcaption>
</figure>
</div>
</section>
<section id="summarizing-data" class="level3">
<h3 class="anchored" data-anchor-id="summarizing-data">Summarizing Data</h3>
<p>We will summarize the data by grouping according to different levels of educational attainment. Weâ€™ll do this in two ways. First we will have data based on different levels up to a bachelorâ€™s degree. Second we will group based on the highest type of degree obtained. The variable <code>college_degree</code> includes Associateâ€™s and Bachelorâ€™s degrees while <code>graduate_degree</code> includes Masterâ€™s, Doctorates, and Professional degrees.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>iowa_ed_grouped1<span class="ot">&lt;-</span>iowa_ed <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name,educational_category) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total=</span><span class="fu">sum</span>(population_estimate)) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>educational_category,<span class="at">values_from=</span>total) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>() <span class="sc">|&gt;</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">str_to_lower</span>(name)) <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">less_than_high_school_pct=</span>less_than_high_school<span class="sc">/</span>total_over_25,<span class="at">high_school_graduate_pct=</span>high_school_graduate<span class="sc">/</span>total_over_25,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">some_college_or_associates_degree_pct=</span>some_college_or_associates_degree<span class="sc">/</span>total_over_25,<span class="at">bachelors_degree_or_higher_pct=</span>bachelors_degree_or_higher<span class="sc">/</span>total_over_25)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'name'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iowa_ed_grouped1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 10
# Groups:   name [6]
  name      less_than_high_school high_school_graduate some_college_or_associaâ€¦Â¹
  &lt;chr&gt;                     &lt;int&gt;                &lt;int&gt;                     &lt;int&gt;
1 adair                       296                 2074                      1800
2 adams                       166                 1042                      1040
3 allamakee                  1135                 3811                      3008
4 appanoose                   876                 3251                      3320
5 audubon                     424                 1495                      1423
6 benton                     1050                 6555                      6221
# â„¹ abbreviated name: Â¹â€‹some_college_or_associates_degree
# â„¹ 6 more variables: bachelors_degree_or_higher &lt;int&gt;, total_over_25 &lt;int&gt;,
#   less_than_high_school_pct &lt;dbl&gt;, high_school_graduate_pct &lt;dbl&gt;,
#   some_college_or_associates_degree_pct &lt;dbl&gt;,
#   bachelors_degree_or_higher_pct &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>iowa_ed_grouped2a<span class="ot">&lt;-</span>iowa_ed <span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name,high_school_diploma,college_degree,graduate_degree) <span class="sc">|&gt;</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total=</span><span class="fu">sum</span>(population_estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'name', 'high_school_diploma',
'college_degree'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>iowa_ed_grouped2<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">name=</span>income<span class="sc">$</span>geographic_name,<span class="at">no_highschool_diploma=</span>iowa_ed_grouped2a<span class="sc">$</span>total[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>,<span class="at">to=</span><span class="dv">491</span>,<span class="at">by=</span><span class="dv">5</span>)],<span class="at">highschool_diploma=</span>iowa_ed_grouped2a<span class="sc">$</span>total[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">2</span>,<span class="at">to=</span><span class="dv">492</span>,<span class="at">by=</span><span class="dv">5</span>)],<span class="at">college_degree=</span>iowa_ed_grouped2a<span class="sc">$</span>total[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">3</span>,<span class="at">to=</span><span class="dv">493</span>,<span class="at">by=</span><span class="dv">5</span>)],<span class="at">graduate_degree=</span>iowa_ed_grouped2a<span class="sc">$</span>total[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">4</span>,<span class="at">to=</span><span class="dv">494</span>,<span class="at">by=</span><span class="dv">5</span>)],<span class="at">total=</span>iowa_ed_grouped2a<span class="sc">$</span>total[<span class="fu">seq</span>(<span class="at">from=</span><span class="dv">5</span>,<span class="at">to=</span><span class="dv">495</span>,<span class="at">by=</span><span class="dv">5</span>)])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iowa_ed_grouped2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 6
  name   no_highschool_diploma highschool_diploma college_degree graduate_degree
  &lt;chr&gt;                  &lt;int&gt;              &lt;int&gt;          &lt;int&gt;           &lt;int&gt;
1 adair                    296               3129           1475             215
2 adams                    166               1657            743              96
3 allamâ€¦                  1135               5615           2463             459
4 appanâ€¦                   876               5491           2104             430
5 audubâ€¦                   424               2435            965             206
6 benton                  1050              10266           5304            1131
# â„¹ 1 more variable: total &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="joining-the-data" class="level3">
<h3 class="anchored" data-anchor-id="joining-the-data">Joining the Data</h3>
<p>We attach our data sets to the grouped education data: income, population, grid location, and map data. The map data will be separate so we can work with a data set containing one row per county for some of the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Make joined data sets, first with the map data and again with just the pop and income data added.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>iowa_education1<span class="ot">&lt;-</span>iowa_ed_grouped1 <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(income,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"geographic_name"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(population,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"geographic_area"</span>))<span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grid_numbers,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"county_name"</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>iowa_education_map1<span class="ot">&lt;-</span>ia_county <span class="sc">|&gt;</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(iowa_education1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"subregion"</span> <span class="ot">=</span> <span class="st">"name"</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>iowa_education2<span class="ot">&lt;-</span>iowa_ed_grouped2 <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(income,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"geographic_name"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(population,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"geographic_area"</span>))<span class="sc">|&gt;</span> </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(grid_numbers,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"name"</span><span class="ot">=</span><span class="st">"county_name"</span>))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>iowa_education_map2<span class="ot">&lt;-</span>ia_county <span class="sc">|&gt;</span> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(iowa_education2, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"subregion"</span> <span class="ot">=</span> <span class="st">"name"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verification" class="level3">
<h3 class="anchored" data-anchor-id="verification">Verification</h3>
<p>Before proceeding with the exploration and analysis, we will quickly check that no errors were introduced during the cleaning and joining process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Do a quick check that the data isn't clearly wrong.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#filter(iowa_education,total_over_25&gt;population_2019)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#iowa_education[2]+iowa_education[3]+iowa_education[4]+iowa_education[5]-iowa_education[6]</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(x=iowa_education$total_over_25,y=iowa_education$population_2019)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="data-exploration">Data Exploration</h2>
</section>
<section id="visualizing-educational-data-geographically" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-educational-data-geographically">Visualizing Educational Data Geographically</h2>
<p>We start by looking at how our data varies across the state.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_map1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> income_2019) )<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_map1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> population_2019) )<span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot education by county. Choose different variables to plot</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_map1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> high_school_graduate_pct) )<span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_map1, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> bachelors_degree_or_higher_pct) )<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>##Analyzing the Data</p>
<p>We will analyze the data to see if which variables are the most indicative of educational attainment. We are most interested in seeing if geographic location has any effect. However we also include population and income.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Linear model for bachelors degree or higher in terms of population and income, with and without interaction. The interaction term is not significant so we remove it.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>(total_over_25<span class="sc">+</span>income_2019)<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ (total_over_25 + 
    income_2019)^2, data = iowa_education1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.118729 -0.028283 -0.008416  0.013594  0.259288 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               -1.649e-02  6.159e-02  -0.268 0.789491    
total_over_25             -1.465e-06  2.136e-06  -0.686 0.494619    
income_2019                3.718e-06  1.015e-06   3.664 0.000409 ***
total_over_25:income_2019  3.352e-11  3.239e-11   1.035 0.303423    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05249 on 95 degrees of freedom
Multiple R-squared:  0.4809,    Adjusted R-squared:  0.4645 
F-statistic: 29.33 on 3 and 95 DF,  p-value: 1.643e-13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>total_over_25<span class="sc">+</span>income_2019))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ total_over_25 + 
    income_2019, data = iowa_education1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.106131 -0.027441 -0.008347  0.013851  0.255028 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -6.236e-02  4.278e-02  -1.458    0.148    
total_over_25  7.407e-07  1.440e-07   5.145 1.42e-06 ***
income_2019    4.456e-06  7.222e-07   6.170 1.62e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05251 on 96 degrees of freedom
Multiple R-squared:  0.475, Adjusted R-squared:  0.4641 
F-statistic: 43.43 on 2 and 96 DF,  p-value: 3.688e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#both terms are significant</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#add grid location</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>x_location<span class="sc">+</span>y_location<span class="sc">+</span>income_2019<span class="sc">+</span>total_over_25))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ x_location + y_location + 
    income_2019 + total_over_25, data = iowa_education1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.104311 -0.027105 -0.009068  0.014998  0.255242 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -6.443e-02  4.446e-02  -1.449    0.151    
x_location     3.821e-04  1.642e-03   0.233    0.817    
y_location    -2.789e-04  2.184e-03  -0.128    0.899    
income_2019    4.477e-06  7.443e-07   6.015 3.43e-08 ***
total_over_25  7.334e-07  1.480e-07   4.955 3.19e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05305 on 94 degrees of freedom
Multiple R-squared:  0.4754,    Adjusted R-squared:  0.4531 
F-statistic:  21.3 on 4 and 94 DF,  p-value: 1.583e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>x_location<span class="sc">+</span>y_location<span class="sc">+</span>income_2019<span class="sc">+</span>total_over_25))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ x_location + y_location + 
    income_2019 + total_over_25, data = iowa_education1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.104311 -0.027105 -0.009068  0.014998  0.255242 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -6.443e-02  4.446e-02  -1.449    0.151    
x_location     3.821e-04  1.642e-03   0.233    0.817    
y_location    -2.789e-04  2.184e-03  -0.128    0.899    
income_2019    4.477e-06  7.443e-07   6.015 3.43e-08 ***
total_over_25  7.334e-07  1.480e-07   4.955 3.19e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.05305 on 94 degrees of freedom
Multiple R-squared:  0.4754,    Adjusted R-squared:  0.4531 
F-statistic:  21.3 on 4 and 94 DF,  p-value: 1.583e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>x_location<span class="sc">+</span>y_location))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ x_location + y_location, 
    data = iowa_education1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.08577 -0.04333 -0.01898  0.01695  0.30223 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.198287   0.021310   9.305 4.64e-15 ***
x_location  0.002096   0.002200   0.953    0.343    
y_location  0.001651   0.002904   0.568    0.571    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.07202 on 96 degrees of freedom
Multiple R-squared:  0.01244,   Adjusted R-squared:  -0.008139 
F-statistic: 0.6044 on 2 and 96 DF,  p-value: 0.5485</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#since income is highly significant in each of these, we use it in a simple regression</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>iowa_education1,bachelors_degree_or_higher_pct<span class="sc">~</span>income_2019))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bachelors_degree_or_higher_pct ~ income_2019, data = iowa_education1)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.10930 -0.03612 -0.01071  0.01491  0.27275 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.043e-01  4.718e-02  -2.210   0.0294 *  
income_2019  5.420e-06  7.836e-07   6.916 4.96e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.059 on 97 degrees of freedom
Multiple R-squared:  0.3303,    Adjusted R-squared:  0.3234 
F-statistic: 47.84 on 1 and 97 DF,  p-value: 4.957e-10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iowa_education1,<span class="fu">aes</span>(<span class="at">x=</span>income_2019,<span class="at">y=</span>bachelors_degree_or_higher_pct))<span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Income"</span>,<span class="at">y=</span><span class="st">"Bachelors Degree or Higher %"</span>)<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On their own, income and population are very good indicators of educational attainment. When we include the grid location as indicator variables, y value 4 and x values 6 and 10 appear as significant in different models. This could be explained by the position of Des Moines and Ames in column 6, Iowa City and Cedar Rapids in column 10, and Des Moines, Iowa City, and the Quad Cities in row 4.</p>
</section>
<section id="clustering-counties" class="level2">
<h2 class="anchored" data-anchor-id="clustering-counties">Clustering Counties</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>med<span class="ot">&lt;-</span>iowa_education1[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mgrid<span class="ot">&lt;-</span>iowa_education1[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">14</span>)]</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>clust_ed<span class="ot">&lt;-</span><span class="fu">kmeans</span>(med, <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>clust_ed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 5 clusters of sizes 40, 3, 8, 34, 14

Cluster means:
  less_than_high_school_pct high_school_graduate_pct
1                0.07647523                0.3549049
2                0.04089540                0.1713302
3                0.15770348                0.3495881
4                0.08608131                0.3978557
5                0.06432862                0.3003066
  some_college_or_associates_degree_pct bachelors_degree_or_higher_pct
1                             0.3588909                      0.2097289
2                             0.2717604                      0.5160140
3                             0.2985285                      0.1941800
4                             0.3417150                      0.1743480
5                             0.3275571                      0.3078076

Clustering vector:
 [1] 4 4 4 4 4 1 5 1 5 1 3 4 1 1 3 1 1 1 4 4 1 4 4 3 2 3 3 4 1 5 5 1 4 1 1 1 4 5
[39] 4 1 1 1 1 1 4 1 4 1 4 4 5 2 4 4 1 4 5 3 4 1 1 4 5 3 1 4 4 4 1 1 4 4 1 5 1 4
[77] 5 1 1 1 1 5 1 5 2 4 4 1 4 1 5 4 4 1 1 5 3 1 1

Within cluster sum of squares by cluster:
[1] 0.0618284149 0.0009405596 0.0278380334 0.0559351271 0.0324085783
 (between_SS / total_SS =  80.9 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>clust_grid<span class="ot">&lt;-</span><span class="fu">kmeans</span>(mgrid, <span class="at">centers =</span> <span class="dv">5</span>, <span class="at">nstart =</span> <span class="dv">10</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>clust_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 5 clusters of sizes 20, 19, 19, 19, 22

Cluster means:
  less_than_high_school_pct high_school_graduate_pct
1                0.07754298                0.3625186
2                0.07545983                0.3577854
3                0.08666637                0.3474674
4                0.08871563                0.3690313
5                0.08881063                0.3443866
  some_college_or_associates_degree_pct bachelors_degree_or_higher_pct
1                             0.3315358                      0.2284026
2                             0.3507930                      0.2159617
3                             0.3520877                      0.2137785
4                             0.3527116                      0.1895415
5                             0.3216495                      0.2451533
  x_location y_location
1  10.600000   4.200000
2   7.947368   7.631579
3   2.894737   7.473684
4   2.526316   3.000000
5   6.727273   2.863636

Clustering vector:
 [1] 4 4 2 5 4 1 2 5 2 1 3 2 3 4 4 1 2 3 2 5 3 1 1 4 5 5 5 1 1 3 1 3 2 2 2 4 4 2
[39] 4 2 2 2 4 1 2 3 3 1 1 5 5 1 1 1 3 1 1 1 5 3 5 5 5 5 4 2 4 5 4 1 3 3 4 3 3 3
[77] 5 4 5 4 3 1 4 3 5 5 4 4 5 5 5 1 5 3 2 2 3 2 2

Within cluster sum of squares by cluster:
[1] 63.74822 65.45169 60.62500 64.78934 81.34619
 (between_SS / total_SS =  80.1 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>clust_grid<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4 4 2 5 4 1 2 5 2 1 3 2 3 4 4 1 2 3 2 5 3 1 1 4 5 5 5 1 1 3 1 3 2 2 2 4 4 2
[39] 4 2 2 2 4 1 2 3 3 1 1 5 5 1 1 1 3 1 1 1 5 3 5 5 5 5 4 2 4 5 4 1 3 3 4 3 3 3
[77] 5 4 5 4 3 1 4 3 5 5 4 4 5 5 5 1 5 3 2 2 3 2 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add the clusters to the data and use it color a county map</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>iowa_education_clustered<span class="ot">&lt;-</span><span class="fu">cbind</span>(iowa_education1,clust_ed<span class="sc">$</span>cluster) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">clusters=</span>...<span class="dv">15</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clusters=</span><span class="fu">factor</span>(clusters,<span class="at">levels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
â€¢ `` -&gt; `...15`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>iowa_education_clustered_map<span class="ot">&lt;-</span>ia_county <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(iowa_education_clustered, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"subregion"</span> <span class="ot">=</span> <span class="st">"name"</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iowa_education_clustered_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   990 obs. of  20 variables:
 $ long                                 : num  -94.2 -94.2 -94.5 -94.7 -94.7 ...
 $ lat                                  : num  41.5 41.2 41.2 41.2 41.5 ...
 $ group                                : num  755 755 755 755 755 755 756 756 756 756 ...
 $ order                                : int  25317 25318 25319 25320 25321 25322 25324 25325 25326 25327 ...
 $ region                               : chr  "iowa" "iowa" "iowa" "iowa" ...
 $ subregion                            : chr  "adair" "adair" "adair" "adair" ...
 $ less_than_high_school                : int  296 296 296 296 296 296 166 166 166 166 ...
 $ high_school_graduate                 : int  2074 2074 2074 2074 2074 2074 1042 1042 1042 1042 ...
 $ some_college_or_associates_degree    : int  1800 1800 1800 1800 1800 1800 1040 1040 1040 1040 ...
 $ bachelors_degree_or_higher           : int  945 945 945 945 945 945 414 414 414 414 ...
 $ total_over_25                        : int  5115 5115 5115 5115 5115 5115 2662 2662 2662 2662 ...
 $ less_than_high_school_pct            : num  0.0579 0.0579 0.0579 0.0579 0.0579 ...
 $ high_school_graduate_pct             : num  0.405 0.405 0.405 0.405 0.405 ...
 $ some_college_or_associates_degree_pct: num  0.352 0.352 0.352 0.352 0.352 ...
 $ bachelors_degree_or_higher_pct       : num  0.185 0.185 0.185 0.185 0.185 ...
 $ income_2019                          : num  57977 57977 57977 57977 57977 ...
 $ population_2019                      : num  7152 7152 7152 7152 7152 ...
 $ x_location                           : int  4 4 4 4 4 4 3 3 3 3 ...
 $ y_location                           : num  3 3 3 3 3 3 2 2 2 2 ...
 $ clusters                             : Factor w/ 5 levels "1","2","3","4",..: 4 4 4 4 4 4 4 4 4 4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_clustered_map, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">fill =</span> clusters) )<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)<span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Now lets try it again using the data which includes the grid position.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>iowa_education_grid_clustered<span class="ot">&lt;-</span><span class="fu">cbind</span>(iowa_education1,clust_grid<span class="sc">$</span>cluster) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">clusters=</span>...<span class="dv">15</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clusters=</span><span class="fu">factor</span>(clusters,<span class="at">levels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
â€¢ `` -&gt; `...15`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>iowa_education_grid_clustered_map<span class="ot">&lt;-</span>ia_county <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(iowa_education_grid_clustered, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"subregion"</span> <span class="ot">=</span> <span class="st">"name"</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iowa_education_grid_clustered_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   990 obs. of  20 variables:
 $ long                                 : num  -94.2 -94.2 -94.5 -94.7 -94.7 ...
 $ lat                                  : num  41.5 41.2 41.2 41.2 41.5 ...
 $ group                                : num  755 755 755 755 755 755 756 756 756 756 ...
 $ order                                : int  25317 25318 25319 25320 25321 25322 25324 25325 25326 25327 ...
 $ region                               : chr  "iowa" "iowa" "iowa" "iowa" ...
 $ subregion                            : chr  "adair" "adair" "adair" "adair" ...
 $ less_than_high_school                : int  296 296 296 296 296 296 166 166 166 166 ...
 $ high_school_graduate                 : int  2074 2074 2074 2074 2074 2074 1042 1042 1042 1042 ...
 $ some_college_or_associates_degree    : int  1800 1800 1800 1800 1800 1800 1040 1040 1040 1040 ...
 $ bachelors_degree_or_higher           : int  945 945 945 945 945 945 414 414 414 414 ...
 $ total_over_25                        : int  5115 5115 5115 5115 5115 5115 2662 2662 2662 2662 ...
 $ less_than_high_school_pct            : num  0.0579 0.0579 0.0579 0.0579 0.0579 ...
 $ high_school_graduate_pct             : num  0.405 0.405 0.405 0.405 0.405 ...
 $ some_college_or_associates_degree_pct: num  0.352 0.352 0.352 0.352 0.352 ...
 $ bachelors_degree_or_higher_pct       : num  0.185 0.185 0.185 0.185 0.185 ...
 $ income_2019                          : num  57977 57977 57977 57977 57977 ...
 $ population_2019                      : num  7152 7152 7152 7152 7152 ...
 $ x_location                           : int  4 4 4 4 4 4 3 3 3 3 ...
 $ y_location                           : num  3 3 3 3 3 3 2 2 2 2 ...
 $ clusters                             : Factor w/ 5 levels "1","2","3","4",..: 4 4 4 4 4 4 4 4 4 4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iowa_education_grid_clustered_map, <span class="fu">aes</span>(<span class="at">x =</span> long, <span class="at">y =</span> lat, </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">fill =</span> clusters) )<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_polygon</span>(<span class="fu">aes</span>(<span class="at">group =</span> group), </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="fl">1.3</span>)<span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets go back to the clustered data and analyze the clusters.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>iowa_education_clustered <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(clusters) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_income=</span><span class="fu">mean</span>(income_2019),<span class="at">mean_bachelors_degree_or_higher_pct=</span><span class="fu">mean</span>(bachelors_degree_or_higher_pct),<span class="at">mean_population=</span><span class="fu">mean</span>(total_over_25))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 Ã— 4
  clusters mean_income mean_bachelors_degree_or_higher_pct mean_population
  &lt;fct&gt;          &lt;dbl&gt;                               &lt;dbl&gt;           &lt;dbl&gt;
1 1             59713.                               0.210          13451.
2 2             76327                                0.516          65084.
3 3             55679.                               0.194          17934.
4 4             56869.                               0.174           9872.
5 5             65518.                               0.308          62885.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we see in the clusters is: - If we include population, we get clusters that clearly correspond to tiers of population. - If we have only education levels and grid location, the clusters are determined by grid location in a way that seems to ignore education.</p>
</section>
<section id="small-counties" class="level2">
<h2 class="anchored" data-anchor-id="small-counties">Small Counties</h2>
<p>In the maps we made previously, there were a handful of very large counties. In the data, we check the most populous counties and the counties with the highest income. We look for any outliers in the data. In particular we will see if we can separate the many small counties from the relatively few large counties, and then analyze these counties separately.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(population,<span class="fu">aes</span>(<span class="at">x=</span>population_2019))<span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(population,<span class="fu">aes</span>(<span class="at">x=</span>population_2019))<span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 5 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">arrange</span>(population,<span class="fu">desc</span>(population_2019)),<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   geographic_area population_2019
1             polk          490161
2             linn          226706
3            scott          172943
4          johnson          151140
5       black hawk          131228
6         woodbury          103107
7          dubuque           97311
8            story           97117
9           dallas           93453
10   pottawattamie           93206
11          warren           51466
12         clinton           46429
13       muscatine           42664
14     cerro gordo           42450
15        marshall           39369
16      des moines           38967
17          jasper           37185
18         webster           35904
19         wapello           34969
20           sioux           34855</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(income,<span class="fu">aes</span>(<span class="at">x=</span>income_2019))<span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(income,<span class="fu">aes</span>(<span class="at">x=</span>income_2019))<span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">arrange</span>(income,<span class="fu">desc</span>(income_2019)),<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   geographic_name income_2019
1           dallas       97535
2           warren       79557
3           grundy       73683
4            mills       72679
5          madison       72578
6            sioux       71566
7            cedar       71029
8         delaware       70091
9           benton       70023
10        plymouth       69165
11        buchanan       67906
12            polk       67331
13          jasper       67317
14         johnson       67295
15          bremer       67229
16            iowa       66861
17          marion       66381
18       dickinson       66211
19            lyon       66139
20           scott       65724</code></pre>
</div>
</div>
<p>In the population data, there is a very stark cutoff after the 10 largest counties. In the income there is one extreme outlier of Dallas county which includes the west Des Moines metro. Dallas county is also one of the 10 largest. In addition to the 10, Warren county in the south Des Moines metro is an outlier in the income data, and the 11th largest county with a gap of 5000 before the next largest county. So we will include Warren along with the 10 largest counties, and group the remaining 88 counties to be considered separately.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>small_counties_education<span class="ot">&lt;-</span>iowa_education1 <span class="sc">|&gt;</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(<span class="fu">filter</span>(population,population_2019<span class="sc">&lt;</span><span class="dv">50000</span>),<span class="fu">join_by</span>(name<span class="sc">==</span>geographic_area))</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(small_counties_education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name           less_than_high_school high_school_graduate
 Length:88          Min.   : 166.0        Min.   : 1042       
 Class :character   1st Qu.: 525.8        1st Qu.: 2484       
 Mode  :character   Median : 723.5        Median : 3578       
                    Mean   : 964.7        Mean   : 4130       
                    3rd Qu.:1120.2        3rd Qu.: 5133       
                    Max.   :4280.0        Max.   :12654       
 some_college_or_associates_degree bachelors_degree_or_higher total_over_25  
 Min.   : 1040                     Min.   : 414               Min.   : 2662  
 1st Qu.: 2446                     1st Qu.:1259               1st Qu.: 6645  
 Median : 3352                     Median :1832               Median : 9777  
 Mean   : 3909                     Mean   :2379               Mean   :11383  
 3rd Qu.: 4604                     3rd Qu.:3033               3rd Qu.:13644  
 Max.   :11771                     Max.   :7217               Max.   :32650  
 less_than_high_school_pct high_school_graduate_pct
 Min.   :0.03598           Min.   :0.2629          
 1st Qu.:0.06713           1st Qu.:0.3465          
 Median :0.07654           Median :0.3707          
 Mean   :0.08519           Mean   :0.3673          
 3rd Qu.:0.09607           3rd Qu.:0.3897          
 Max.   :0.21554           Max.   :0.4437          
 some_college_or_associates_degree_pct bachelors_degree_or_higher_pct
 Min.   :0.2657                        Min.   :0.1267                
 1st Qu.:0.3280                        1st Qu.:0.1765                
 Median :0.3484                        Median :0.1933                
 Mean   :0.3452                        Mean   :0.2023                
 3rd Qu.:0.3670                        3rd Qu.:0.2212                
 Max.   :0.3964                        Max.   :0.3355                
  income_2019    population_2019   x_location       y_location   
 Min.   :41672   Min.   : 3602   Min.   : 1.000   Min.   :1.000  
 1st Qu.:54111   1st Qu.: 9517   1st Qu.: 3.000   1st Qu.:3.000  
 Median :57698   Median :13901   Median : 6.000   Median :5.000  
 Mean   :58706   Mean   :16446   Mean   : 6.091   Mean   :5.011  
 3rd Qu.:62330   3rd Qu.:19726   3rd Qu.: 9.000   3rd Qu.:7.000  
 Max.   :73683   Max.   :46429   Max.   :12.000   Max.   :9.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(small_counties_education,<span class="fu">aes</span>(<span class="at">x=</span>population_2019))<span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(small_counties_education,<span class="fu">aes</span>(<span class="at">x=</span>income_2019))<span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Iowa-Education-by-County_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>